/* rxjs@7.8.0 */
System.register(["./rxjs-shared.min.js"],(function(e){"use strict";var r,t,n,i,a,s,o,u,c,l,f,h,d,b,m,p,v,w,g,y;return{setters:[function(e){r=e._,t=e.S,n=e.o,i=e.O,a=e.a,s=e.b,o=e.n,u=e.e,c=e.C,l=e.c,f=e.d,h=e.f,d=e.g,b=e.i,m=e.h,p=e.t,v=e.p,w=e.V,g=e.j,y=e.k}],execute:function(){var x=function(e,r){void 0===r&&(r=1/0),this.subscribedFrame=e,this.unsubscribedFrame=r},F=function(){function e(){this.subscriptions=[]}return e.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new x(this.scheduler.now())),this.subscriptions.length-1},e.prototype.logUnsubscribedFrame=function(e){var r=this.subscriptions,t=r[e];r[e]=new x(t.subscribedFrame,this.scheduler.now())},e}(),k=function(e){function i(r,n){var i=e.call(this,(function(e){var r=this,n=r.logSubscribedFrame(),i=new t;return i.add(new t((function(){r.logUnsubscribedFrame(n)}))),r.scheduleMessages(e),i}))||this;return i.messages=r,i.subscriptions=[],i.scheduler=n,i}return r(i,e),i.prototype.scheduleMessages=function(e){for(var r=this.messages.length,t=0;t<r;t++){var i=this.messages[t];e.add(this.scheduler.schedule((function(e){var r=e,t=r.message.notification,i=r.subscriber;n(t,i)}),i.frame,{message:i,subscriber:e}))}},i}(i);a(k,[F]);var O=function(e){function i(r,t){var n=e.call(this)||this;return n.messages=r,n.subscriptions=[],n.scheduler=t,n}return r(i,e),i.prototype._subscribe=function(r){var n=this,i=n.logSubscribedFrame(),a=new t;return a.add(new t((function(){n.logUnsubscribedFrame(i)}))),a.add(e.prototype._subscribe.call(this,r)),a},i.prototype.setup=function(){for(var e=this,r=e.messages.length,t=function(r){var t,i,a;t=e.messages[r],i=t.notification,a=t.frame,e.scheduler.schedule((function(){n(i,e)}),a)},i=0;i<r;i++)t(i)},i}(s);a(O,[F]);e("T",function(e){function t(r){var t=e.call(this,g,750)||this;return t.assertDeepEqual=r,t.hotObservables=[],t.coldObservables=[],t.flushTests=[],t.runMode=!1,t}return r(t,e),t.prototype.createTime=function(e){var r=this.runMode?e.trim().indexOf("|"):e.indexOf("|");if(-1===r)throw new Error('marble diagram for time should have a completion marker "|"');return r*t.frameTimeFactor},t.prototype.createColdObservable=function(e,r,n){if(-1!==e.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==e.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,r,n,void 0,this.runMode),a=new k(i,this);return this.coldObservables.push(a),a},t.prototype.createHotObservable=function(e,r,n){if(-1!==e.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,r,n,void 0,this.runMode),a=new O(i,this);return this.hotObservables.push(a),a},t.prototype.materializeInnerObservable=function(e,r){var t=this,n=[];return e.subscribe({next:function(e){n.push({frame:t.frame-r,notification:o(e)})},error:function(e){n.push({frame:t.frame-r,notification:u(e)})},complete:function(){n.push({frame:t.frame-r,notification:c})}}),n},t.prototype.expectObservable=function(e,r){var n=this;void 0===r&&(r=null);var a,s=[],l={actual:s,ready:!1},f=t.parseMarblesAsSubscriptions(r,this.runMode),h=f.subscribedFrame===1/0?0:f.subscribedFrame,d=f.unsubscribedFrame;this.schedule((function(){a=e.subscribe({next:function(e){var r=e instanceof i?n.materializeInnerObservable(e,n.frame):e;s.push({frame:n.frame,notification:o(r)})},error:function(e){s.push({frame:n.frame,notification:u(e)})},complete:function(){s.push({frame:n.frame,notification:c})}})}),h),d!==1/0&&this.schedule((function(){return a.unsubscribe()}),d),this.flushTests.push(l);var b=this.runMode;return{toBe:function(e,r,n){l.ready=!0,l.expected=t.parseMarbles(e,r,n,!0,b)},toEqual:function(e){l.ready=!0,l.expected=[],n.schedule((function(){a=e.subscribe({next:function(e){var r=e instanceof i?n.materializeInnerObservable(e,n.frame):e;l.expected.push({frame:n.frame,notification:o(r)})},error:function(e){l.expected.push({frame:n.frame,notification:u(e)})},complete:function(){l.expected.push({frame:n.frame,notification:c})}})}),h)}}},t.prototype.expectSubscriptions=function(e){var r={actual:e,ready:!1};this.flushTests.push(r);var n=this.runMode;return{toBe:function(e){var i="string"==typeof e?[e]:e;r.ready=!0,r.expected=i.map((function(e){return t.parseMarblesAsSubscriptions(e,n)})).filter((function(e){return e.subscribedFrame!==1/0}))}}},t.prototype.flush=function(){for(var r=this,t=this.hotObservables;t.length>0;)t.shift().setup();e.prototype.flush.call(this),this.flushTests=this.flushTests.filter((function(e){return!e.ready||(r.assertDeepEqual(e.actual,e.expected),!1)}))},t.parseMarblesAsSubscriptions=function(e,r){var t=this;if(void 0===r&&(r=!1),"string"!=typeof e)return new x(1/0);for(var n,i=l([],f(e)),a=i.length,s=-1,o=1/0,u=1/0,c=0,h=function(e){var a=c,l=function(e){a+=e*t.frameTimeFactor},f=i[e];switch(f){case" ":r||l(1);break;case"-":l(1);break;case"(":s=c,l(1);break;case")":s=-1,l(1);break;case"^":if(o!==1/0)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");o=s>-1?s:c,l(1);break;case"!":if(u!==1/0)throw new Error("found a second unsubscription point '!' in a subscription marble diagram. There can only be one.");u=s>-1?s:c;break;default:if(r&&f.match(/^[0-9]$/)&&(0===e||" "===i[e-1])){var h=i.slice(e).join("").match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(h){e+=h[0].length-1;var b=parseFloat(h[1]),m=void 0;switch(h[2]){case"ms":m=b;break;case"s":m=1e3*b;break;case"m":m=1e3*b*60}l(m/d.frameTimeFactor);break}}throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+f+"'.")}c=a,n=e},d=this,b=0;b<a;b++)h(b),b=n;return u<0?new x(o):new x(o,u)},t.parseMarbles=function(e,r,t,n,i){var a=this;if(void 0===n&&(n=!1),void 0===i&&(i=!1),-1!==e.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var s,h=l([],f(e)),d=h.length,b=[],m=i?e.replace(/^[ ]+/,"").indexOf("^"):e.indexOf("^"),p=-1===m?0:m*-this.frameTimeFactor,v="object"!=typeof r?function(e){return e}:function(e){return n&&r[e]instanceof k?r[e].messages:r[e]},w=-1,g=function(e){var r=p,n=function(e){r+=e*a.frameTimeFactor},l=void 0,f=h[e];switch(f){case" ":i||n(1);break;case"-":n(1);break;case"(":w=p,n(1);break;case")":w=-1,n(1);break;case"|":l=c,n(1);break;case"^":n(1);break;case"#":l=u(t||"error"),n(1);break;default:if(i&&f.match(/^[0-9]$/)&&(0===e||" "===h[e-1])){var d=h.slice(e).join("").match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(d){e+=d[0].length-1;var m=parseFloat(d[1]),g=void 0;switch(d[2]){case"ms":g=m;break;case"s":g=1e3*m;break;case"m":g=1e3*m*60}n(g/y.frameTimeFactor);break}}l=o(v(f)),n(1)}l&&b.push({frame:w>-1?w:p,notification:l}),p=r,s=e},y=this,x=0;x<d;x++)g(x),x=s;return b},t.prototype.createAnimator=function(){var e=this;if(!this.runMode)throw new Error("animate() must only be used in run mode");var r,n=0;return{animate:function(n){var i,a;if(r)throw new Error("animate() must not be called more than once within run()");if(/[|#]/.test(n))throw new Error("animate() must not complete or error");r=new Map;var s=t.parseMarbles(n,void 0,void 0,void 0,!0);try{for(var o=y(s),u=o.next();!u.done;u=o.next()){var c=u.value;e.schedule((function(){var t,n,i=e.now(),a=Array.from(r.values());r.clear();try{for(var s=(t=void 0,y(a)),o=s.next();!o.done;o=s.next()){(0,o.value)(i)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}),c.frame)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}},delegate:{requestAnimationFrame:function(e){if(!r)throw new Error("animate() was not called within run()");var t=++n;return r.set(t,e),t},cancelAnimationFrame:function(e){if(!r)throw new Error("animate() was not called within run()");r.delete(e)}}}},t.prototype.createDelegates=function(){var e=this,r=0,t=new Map,n=function(){var r=e.now(),i=Array.from(t.values()).filter((function(e){return e.due<=r})),a=i.filter((function(e){return"immediate"===e.type}));if(a.length>0){var s=a[0],o=s.handle,u=s.handler;return t.delete(o),void u()}var c=i.filter((function(e){return"interval"===e.type}));if(c.length>0){var l=c[0],f=l.duration;u=l.handler;return l.due=r+f,l.subscription=e.schedule(n,f),void u()}var h=i.filter((function(e){return"timeout"===e.type}));if(h.length>0){var d=h[0];o=d.handle,u=d.handler;return t.delete(o),void u()}throw new Error("Expected a due immediate or interval")};return{immediate:{setImmediate:function(i){var a=++r;return t.set(a,{due:e.now(),duration:0,handle:a,handler:i,subscription:e.schedule(n,0),type:"immediate"}),a},clearImmediate:function(e){var r=t.get(e);r&&(r.subscription.unsubscribe(),t.delete(e))}},interval:{setInterval:function(i,a){void 0===a&&(a=0);var s=++r;return t.set(s,{due:e.now()+a,duration:a,handle:s,handler:i,subscription:e.schedule(n,a),type:"interval"}),s},clearInterval:function(e){var r=t.get(e);r&&(r.subscription.unsubscribe(),t.delete(e))}},timeout:{setTimeout:function(i,a){void 0===a&&(a=0);var s=++r;return t.set(s,{due:e.now()+a,duration:a,handle:s,handler:i,subscription:e.schedule(n,a),type:"timeout"}),s},clearTimeout:function(e){var r=t.get(e);r&&(r.subscription.unsubscribe(),t.delete(e))}}}},t.prototype.run=function(e){var r=t.frameTimeFactor,n=this.maxFrames;t.frameTimeFactor=1,this.maxFrames=1/0,this.runMode=!0;var i=this.createAnimator(),a=this.createDelegates();h.delegate=i.delegate,d.delegate=this,b.delegate=a.immediate,m.delegate=a.interval,p.delegate=a.timeout,v.delegate=this;var s={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),time:this.createTime.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this),animate:i.animate};try{var o=e(s);return this.flush(),o}finally{t.frameTimeFactor=r,this.maxFrames=n,this.runMode=!1,h.delegate=void 0,d.delegate=void 0,b.delegate=void 0,m.delegate=void 0,p.delegate=void 0,v.delegate=void 0}},t.frameTimeFactor=10,t}(w))}}}));
